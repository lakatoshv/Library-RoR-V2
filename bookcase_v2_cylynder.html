<body>
	<link rel='stylesheet' href='bootstrap/css/bootstrap.css'/>
    <meta charset="utf-8">   
    <script src='js/jquery3-2-1.js'></script>
    <script data-require='bootstrap@3.2.1' data-semver='3.2.1' src='bootstrap/js/bootstrap3.2.1.js'></script>
    <script data-require='jquery@3.2.1' data-semver='3.2.1' src='js/jquery3-2-1.js'></script>
    <script src='bootstrap/js/bootstrap-tab.js'></script>
    <script src='bootstrap/js/bootstrap-dropdown.js'></script>
    <script src='js/popper.js'></script>
	<script src="https://rawgit.com/mrdoob/three.js/master/build/three.min.js"></script>
	<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/libs/stats.min.js"></script>
	<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/renderers/CanvasRenderer.js"></script>
	<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/renderers/Projector.js"></script>
	<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/libs/tween.min.js"></script>7
	<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/controls/OrbitControls.js"></script>
	<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/renderers/CSS3DRenderer.js"></script>
	<style>
			#menu {
				position: absolute;
				bottom: 20px;
				width: 100%;
				text-align: center;
			}
			#menu button {
				color: rgba(127,255,255,0.75);
				background: gray;
				outline: 1px solid rgba(127,255,255,0.75);
				border: 0px;
				padding: 5px 10px;
				cursor: pointer;
			}
			#menu button:hover {
				background-color: black;
			}
			#menu button:active {
				color: #000000;
				background-color: black;
			}
	</style>
	
<div id="container"></div>
<div id="menu" >
	<button id="table">TABLE</button>
	<button id="helix">HELIX</button>
</div>
	<script>
	var config = {
				canvas_width:			window.innerWidth,
				canvas_height:			window.innerHeight,
				
				room_x:					4000,
				room_y:					2400,
				room_z:					4000,
				
				camera_position:		[1900, 0, 1900],
				//camera_position:		[-2400, 0, 1000],
				//camera_target:		[-2600, 0, 1300],
				camera_target:			[0, 0, 0],
				
				//controls_target:		[-2600, 0, 1300],
				controls_target:		[0, 0, 0],
				controls_allow_move:	true,
				controls_allow_zoom:	true,
				
				axis_helpers:			false,
				
				json_models:			['door.js']
			};
	var bookid = 0;
	var targets = { table: [], sphere: [], helix: [], grid: [] };
	var books = {
			"0": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"1": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"2": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"3": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"4": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"5": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"6": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"7": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"8": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"9": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"10": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"11": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"12": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"13": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"14": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"15": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"16": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"17": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"18": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"19": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"20": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"21": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"22": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"23": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"24": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"25": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"26": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"27": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"28": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"29": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"30": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"31": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"32": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"33": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"34": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"35": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"36": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"37": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"38": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"39": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"40": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"41": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"42": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"43": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"44": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"45": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"46": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"47": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"48": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			},
			"49": {
				"name": "Книга",
				"author": "Автор",
				"img": "book.jpg",
				"minidescription": "Текст Текст Текст Текст Текст Текст Текст м Текст Текст Текст"
			}
			
		}
		var objects = [];
		var intersects;
		var arrlength = Object.keys( books ).length;
		var numCubes = 10;
		var container, stats;
		var camera, scene, renderer, controls;
		var textureLoader = new THREE.TextureLoader();
		var raycaster;
		var mouse;
		var isMouseDown = false,
			onMouseDownPosition, onMouseDownTheta = 45,
			onMouseDownPhi = 60,
			phi = 60,
		camerapos = 0,	theta = 0,
			radious = 1600,
			count=0;
		var lichilnick = 0;
		var startX = -1800, startY = 800, x = 0, y = 0, z = 0;
		init();
		animate();
		function ChangeImage(id,image){
                var el=document.getElementById(id);
                el.src=image;
        }
		function init(type) {
			container = document.createElement('div');
			document.getElementById( 'container' ).appendChild(container);
			camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 1, 10000);
			camera.position.y = 360;
			camera.position.z = 1500;
			raycaster = new THREE.Raycaster();
			mouse = new THREE.Vector2();
			stats = new Stats();
			container.appendChild(stats.dom);

			createScene(type);
			onMouseDownPosition = new THREE.Vector2();
			document.addEventListener('mousedown', onDocumentMouseDown, false);
			window.addEventListener('resize', onWindowResize, false);
			controls = new THREE.OrbitControls( camera, renderer.domElement );
				controls.rotateSpeed = 10;
				controls.target = new THREE.Vector3( config['controls_target'][0], config['controls_target'][1], config['controls_target'][2] );
				controls.noRotate = config['controls_allow_move'] ? false : true;
				controls.minDistance = config['controls_allow_zoom'] ? 700 : 2600;
				controls.maxDistance = 2600; // 2900
				controls.minPolarAngle = d2r(70);
				controls.maxPolarAngle = d2r(110);
	
				controls.addEventListener( 'change', render );
		}


		function createGeometry(id, bookname, auth, img, minidescr) {

			var cubeTexture = textureLoader.load(img);
			var geometry = new THREE.BoxBufferGeometry(200, 300, 50);
			var object = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({
				color: Math.random() * 0xffffff,
				map: cubeTexture,
				active: false,
				type: "book",
				id: `${id}`
			}));
			books[object.id] = {
				"name": bookname,
				"author": auth,
				"img": img,
				"minidescription": minidescr
			}
			object.position.x = x;
			object.position.y = y;
			object.position.z = z;
			return object;
		}

		function createScene(type) {
			scene = new THREE.Scene();
			renderer = new THREE.WebGLRenderer({
				antialias: true
			});
			renderer.autoClear = true;
			renderer = new THREE.CanvasRenderer();
			renderer.setClearColor(0xf0f0f0);
			renderer.setPixelRatio(window.devicePixelRatio);
			renderer.setSize(window.innerWidth, window.innerHeight);
			container.appendChild(renderer.domElement);
			
			var cylindrical = new THREE.Cylindrical();
			
			for ( var i = 0; i < arrlength; i ++ ) {
				var thetat = i * 0.175 + Math.PI;
				var yt = - ( i * 8 ) + 200;
				var object = new THREE.Object3D();
				cylindrical.set( 400, thetat, yt );
				object.position.setFromCylindrical( cylindrical );
				x = object.position.x * 2;
				y = object.position.y *1.2;
				z = object.position.z * 2;
				var geometry = createGeometry(i, books[i].name, books[i].author, books[i].img, books[i].minidescription);
				objects.push( geometry );
				scene.add(geometry);
			}
			
		}
		
			function transform( targets, duration ) {
				TWEEN.removeAll();
				for ( var i = 0; i < objects.length; i ++ ) {
					var object = objects[ i ];
					var target = targets[ i ];
					new TWEEN.Tween( object.position )
						.to( { x: target.position.x, y: target.position.y, z: target.position.z }, Math.random() * duration + duration )
						.easing( TWEEN.Easing.Exponential.InOut )
						.start();
					new TWEEN.Tween( object.rotation )
						.to( { x: target.rotation.x, y: target.rotation.y, z: target.rotation.z }, Math.random() * duration + duration )
						.easing( TWEEN.Easing.Exponential.InOut )
						.start();
				}
				new TWEEN.Tween( this )
					.to( {}, duration * 2 )
					.onUpdate( render )
					.start();
			}

		function onWindowResize() {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();
			renderer.setSize(window.innerWidth, window.innerHeight);
		}
		function turnBack(){
		}
		function onDocumentMouseDown(event) {
			isMouseDown = true;
			onMouseDownTheta = theta;
			onMouseDownPhi = phi;
			onMouseDownPosition.x = event.clientX;
			onMouseDownPosition.y = event.clientY;
			mouse.x = (event.clientX / renderer.domElement.clientWidth) * 2 - 1;
			mouse.y = -(event.clientY / renderer.domElement.clientHeight) * 2 + 1;
			raycaster.setFromCamera(mouse, camera);
			intersects = raycaster.intersectObjects(scene.children);
			
			if (intersects.length > 0 /*&& intersects[0].object.type == "book"*/) {
				if(intersects[0].object.id == bookid) {
					theta = - 15;
				}
				else theta = + 200;
				new TWEEN.Tween(intersects[0].object.position).to(
					{
						z: theta
					}, 2000)
				.easing(TWEEN.Easing.Elastic.Out).start(); //moves cube
					count++;
					if(intersects[0].object.id != bookid){
						var id = intersects[0].object.id
						bookid = id;
						document.getElementById("modal-title").firstChild.nodeValue = books[id].name + " № " + id;
						document.getElementById("modal-author").firstChild.nodeValue = books[id].author + id;
						ChangeImage("body-img", books[id].img);
						document.getElementById("body-text").firstChild.nodeValue = books[id].minidescription;
						document.getElementById('click').click();
						for(j = 0; j < object.lenght; j++){
							theta = - 185;
							if(id != object.id){
								new TWEEN.Tween(object[id].position).to({
									z: theta
								}, 2000)
							}
						}
					}
					else{
						bookid = 0;
					}
				
			}
		}

		function onDocumentMouseUp(event) {
			isMouseDown = false;
		}

		function animate() {
			requestAnimationFrame(animate);
			controls.update();
			render();
			stats.update();
		}


		function render() {
			camera.lookAt(scene.position);
			renderer.render(scene, camera);
		}
		function d2r(degrees){
				return degrees * Math.PI / 180;
			}

	</script>
<button type="button" id="click" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" style="display: none;">
</button>
	<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="modal-title">Modal title</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="modal-body">
		<h3 class="modal-title" id="modal-author">Modal title</h3>
		<div id="body-image"><img id="body-img" src="" height="500" wight="200"/></div>
		<p id="body-text">...</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Переглянути</button>
		<button type="button" class="btn btn-primary">Читати онлайн</button>
		<button type="button" class="btn btn-primary">Слухатин</button>
		<button type="button" class="btn btn-primary">Скачати</button>
		<button type="button" class="btn btn-secondary" data-dismiss="modal">Закрити</button>
      </div>
    </div>
  </div>
</div>
</body>